{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{useCategory}from'../context/CategoryContext';import{useCart}from'../context/CartContext';import CartOverlay from'./CartOverlay';import{request,gql}from'graphql-request';import'./Header.css';import Logo from'../assets/logo.svg';import Cart from'../assets/cart.svg';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Header=()=>{const{activeCategory,setActiveCategory}=useCategory();const{cartItems}=useCart();const navigate=useNavigate();const[categories,setCategories]=useState([]);const[isCartOpen,setCartOpen]=useState(false);const[loading,setLoading]=useState(true);// Fetch categories asynchronously\nconst fetchCategories=async()=>{const query=gql`\n      {\n        categories {\n          id\n          name\n        }\n      }\n    `;try{const data=await request('http://localhost:8000/graphql.php',query);setCategories(data.categories);}catch(error){console.error('Error fetching categories:',error);}finally{setLoading(false);// Ensure loading is set to false regardless of success or error\n}};useEffect(()=>{fetchCategories();},[]);const handleCategoryClick=category=>{// Category name is already a string, so no change needed\nsetActiveCategory(category);navigate('/');};const toggleCartOverlay=()=>{setCartOpen(true);};const closeCartOverlay=()=>{setCartOpen(false);};const totalItems=cartItems.reduce((total,item)=>total+item.quantity,0);return/*#__PURE__*/_jsxs(\"header\",{className:\"header-container\",children:[/*#__PURE__*/_jsx(\"nav\",{className:\"nav\",\"data-testid\":\"category-container\",children:loading?/*#__PURE__*/_jsx(\"span\",{children:\"Loading categories...\"}):categories.map(category=>/*#__PURE__*/_jsx(\"span\",{className:`nav-link ${activeCategory===category.name?'active':''}`,onClick:()=>handleCategoryClick(category.name),\"data-testid\":`category-link-${category.name}`,children:category.name},category.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"logo-container\",children:/*#__PURE__*/_jsx(\"img\",{src:Logo,alt:\"Logo\",className:\"logo\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-icon-container\",\"data-testid\":\"cart-btn\",onClick:toggleCartOverlay,children:[/*#__PURE__*/_jsx(\"img\",{src:Cart,alt:\"Cart\",className:\"cart-icon\"}),totalItems>0&&/*#__PURE__*/_jsx(\"div\",{className:\"cart-item-count\",children:totalItems})]}),isCartOpen&&/*#__PURE__*/_jsx(CartOverlay,{isOpen:isCartOpen,onClose:closeCartOverlay,\"data-testid\":\"cart-overlay\"})]});};export default Header;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useCategory","useCart","CartOverlay","request","gql","Logo","Cart","jsx","_jsx","jsxs","_jsxs","Header","activeCategory","setActiveCategory","cartItems","navigate","categories","setCategories","isCartOpen","setCartOpen","loading","setLoading","fetchCategories","query","data","error","console","handleCategoryClick","category","toggleCartOverlay","closeCartOverlay","totalItems","reduce","total","item","quantity","className","children","map","name","onClick","id","src","alt","isOpen","onClose"],"sources":["C:/xampp/htdocs/ecommerceproject/frontend/src/Components/Header.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useCategory } from '../context/CategoryContext';\r\nimport { useCart } from '../context/CartContext';\r\nimport CartOverlay from './CartOverlay';\r\nimport { request, gql } from 'graphql-request';\r\nimport './Header.css';\r\nimport Logo from '../assets/logo.svg';\r\nimport Cart from '../assets/cart.svg';\r\n\r\nconst Header = () => {\r\n  const { activeCategory, setActiveCategory } = useCategory();\r\n  const { cartItems } = useCart();\r\n  const navigate = useNavigate();\r\n  const [categories, setCategories] = useState([]);\r\n  const [isCartOpen, setCartOpen] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Fetch categories asynchronously\r\n  const fetchCategories = async () => {\r\n    const query = gql`\r\n      {\r\n        categories {\r\n          id\r\n          name\r\n        }\r\n      }\r\n    `;\r\n\r\n    try {\r\n      const data = await request('http://localhost:8000/graphql.php', query);\r\n      setCategories(data.categories);\r\n    } catch (error) {\r\n      console.error('Error fetching categories:', error);\r\n    } finally {\r\n      setLoading(false); // Ensure loading is set to false regardless of success or error\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchCategories();\r\n  }, []);\r\n\r\n  const handleCategoryClick = (category) => {\r\n    // Category name is already a string, so no change needed\r\n    setActiveCategory(category);\r\n    navigate('/');\r\n  };\r\n\r\n  const toggleCartOverlay = () => {\r\n    setCartOpen(true);\r\n  };\r\n\r\n  const closeCartOverlay = () => {\r\n    setCartOpen(false);\r\n  };\r\n\r\n  const totalItems = cartItems.reduce((total, item) => total + item.quantity, 0);\r\n\r\n  return (\r\n    <header className=\"header-container\">\r\n      <nav className=\"nav\" data-testid=\"category-container\">\r\n        {loading ? (\r\n          <span>Loading categories...</span>\r\n        ) : (\r\n          categories.map((category) => (\r\n            <span\r\n              key={category.id}\r\n              className={`nav-link ${activeCategory === category.name ? 'active' : ''}`}\r\n              onClick={() => handleCategoryClick(category.name)}\r\n              data-testid={`category-link-${category.name}`}\r\n            >\r\n              {category.name}\r\n            </span>\r\n          ))\r\n        )}\r\n      </nav>\r\n\r\n      <div className=\"logo-container\">\r\n        <img src={Logo} alt=\"Logo\" className=\"logo\" />\r\n      </div>\r\n      <div className=\"cart-icon-container\" data-testid=\"cart-btn\" onClick={toggleCartOverlay}>\r\n        <img src={Cart} alt=\"Cart\" className=\"cart-icon\" />\r\n        {totalItems > 0 && (\r\n          <div className=\"cart-item-count\">\r\n            {totalItems}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {isCartOpen && <CartOverlay isOpen={isCartOpen} onClose={closeCartOverlay} data-testid=\"cart-overlay\" />}\r\n    </header>\r\n  );\r\n};\r\n\r\nexport default Header;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}