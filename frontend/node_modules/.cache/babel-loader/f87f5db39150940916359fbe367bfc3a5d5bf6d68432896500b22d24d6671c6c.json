{"ast":null,"code":"import React,{useEffect,useState}from'react';import'./ProductList.css';import{request,gql}from'graphql-request';import CartIcon from'../assets/carticon.svg';import{Link}from'react-router-dom';import{useCategory}from'../context/CategoryContext';import{useCart}from'../context/CartContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProductList=()=>{const{activeCategory}=useCategory();const[products,setProducts]=useState([]);const[loading,setLoading]=useState(false);// Add loading state\nconst{addToCart}=useCart();useEffect(()=>{const fetchProducts=async()=>{setLoading(true);// Start loading\nconst endpoint='https://scandiwebtask-c44363ca7aa2.herokuapp.com/graphql.php';const query=gql`\n        query($category: String) {\n          products(category: $category) {\n            id\n            name\n            inStock\n            category\n            imageUrl\n            prices {\n              amount\n              currencySymbol\n            }\n            attributes {\n              id\n              name\n              items {\n                id\n                display_value\n                value\n              }\n            }\n          }\n        }\n      `;const categoryValue=activeCategory==='all'?null:activeCategory==='clothes'?'2':'3';try{const data=await request(endpoint,query,{category:categoryValue});setProducts(data.products);}catch(error){console.error('Error fetching products:',error);}finally{setLoading(false);// End loading\n}};fetchProducts();},[activeCategory]);const handleQuickShop=(event,product)=>{var _product$attributes$f,_product$attributes$f2,_product$attributes$f3,_product$attributes$f4,_product$attributes$f5,_product$attributes$f6,_product$attributes$f7,_product$attributes$f8,_product$attributes$f9,_product$attributes$f10,_product$prices,_product$prices$;event.preventDefault();event.stopPropagation();const selectedColor=((_product$attributes$f=product.attributes.find(attr=>attr.name===\"Color\"))===null||_product$attributes$f===void 0?void 0:(_product$attributes$f2=_product$attributes$f.items[0])===null||_product$attributes$f2===void 0?void 0:_product$attributes$f2.value)||\"\";const selectedCapacity=((_product$attributes$f3=product.attributes.find(attr=>attr.name===\"Capacity\"))===null||_product$attributes$f3===void 0?void 0:(_product$attributes$f4=_product$attributes$f3.items[0])===null||_product$attributes$f4===void 0?void 0:_product$attributes$f4.value)||\"\";const selectedSize=((_product$attributes$f5=product.attributes.find(attr=>attr.name===\"Size\"))===null||_product$attributes$f5===void 0?void 0:(_product$attributes$f6=_product$attributes$f5.items[0])===null||_product$attributes$f6===void 0?void 0:_product$attributes$f6.value)||\"\";const selectedTouchID=((_product$attributes$f7=product.attributes.find(attr=>attr.name===\"Touch ID in keyboard\"))===null||_product$attributes$f7===void 0?void 0:(_product$attributes$f8=_product$attributes$f7.items[0])===null||_product$attributes$f8===void 0?void 0:_product$attributes$f8.value)||\"\";const selectedUSBPorts=((_product$attributes$f9=product.attributes.find(attr=>attr.name===\"With USB 3 ports\"))===null||_product$attributes$f9===void 0?void 0:(_product$attributes$f10=_product$attributes$f9.items[0])===null||_product$attributes$f10===void 0?void 0:_product$attributes$f10.value)||\"\";const productWithDefaults={...product,selectedColor,selectedCapacity,selectedSize,selectedTouchID,selectedUSBPorts,price:((_product$prices=product.prices)===null||_product$prices===void 0?void 0:(_product$prices$=_product$prices[0])===null||_product$prices$===void 0?void 0:_product$prices$.amount)||0,quantity:1};addToCart(productWithDefaults);};const filteredProducts=activeCategory==='all'?products:products.filter(product=>activeCategory==='clothes'?product.category==='2':product.category==='3');return/*#__PURE__*/_jsxs(\"div\",{className:\"product-list-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:activeCategory==='all'?'all':activeCategory}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading products...\"})// Display loading message while fetching\n:/*#__PURE__*/_jsxs(\"div\",{className:\"product-grid\",children:[filteredProducts.length===0&&/*#__PURE__*/_jsx(\"p\",{children:\"No products available.\"}),filteredProducts.map(product=>{var _product$prices2,_product$prices2$,_product$prices3,_product$prices3$;return/*#__PURE__*/_jsxs(\"div\",{className:`product-card ${product.inStock?'':'out-of-stock'}`,\"data-testid\":`product-${product.name.toLowerCase().replace(/\\s+/g,'-')}`,children:[/*#__PURE__*/_jsxs(Link,{to:`/product/${product.id}`,className:\"product-image-link\",children:[/*#__PURE__*/_jsx(\"img\",{src:product.imageUrl||'default-image-url',alt:product.name,className:\"product-image\",style:{filter:product.inStock?'none':'grayscale(100%)'}}),!product.inStock&&/*#__PURE__*/_jsx(\"div\",{className:\"out-of-stock-label\",children:\"OUT OF STOCK\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:product.name}),/*#__PURE__*/_jsxs(\"p\",{children:[((_product$prices2=product.prices)===null||_product$prices2===void 0?void 0:(_product$prices2$=_product$prices2[0])===null||_product$prices2$===void 0?void 0:_product$prices2$.currencySymbol)||\"$\",(((_product$prices3=product.prices)===null||_product$prices3===void 0?void 0:(_product$prices3$=_product$prices3[0])===null||_product$prices3$===void 0?void 0:_product$prices3$.amount)||0).toFixed(2)]})]}),product.inStock&&/*#__PURE__*/_jsx(\"div\",{className:\"quick-shop\",onClick:e=>handleQuickShop(e,product),children:/*#__PURE__*/_jsx(\"img\",{src:CartIcon,alt:\"Cart\"})})]},product.id);})]})]});};export default ProductList;","map":{"version":3,"names":["React","useEffect","useState","request","gql","CartIcon","Link","useCategory","useCart","jsx","_jsx","jsxs","_jsxs","ProductList","activeCategory","products","setProducts","loading","setLoading","addToCart","fetchProducts","endpoint","query","categoryValue","data","category","error","console","handleQuickShop","event","product","_product$attributes$f","_product$attributes$f2","_product$attributes$f3","_product$attributes$f4","_product$attributes$f5","_product$attributes$f6","_product$attributes$f7","_product$attributes$f8","_product$attributes$f9","_product$attributes$f10","_product$prices","_product$prices$","preventDefault","stopPropagation","selectedColor","attributes","find","attr","name","items","value","selectedCapacity","selectedSize","selectedTouchID","selectedUSBPorts","productWithDefaults","price","prices","amount","quantity","filteredProducts","filter","className","children","length","map","_product$prices2","_product$prices2$","_product$prices3","_product$prices3$","inStock","toLowerCase","replace","to","id","src","imageUrl","alt","style","currencySymbol","toFixed","onClick","e"],"sources":["C:/xampp/htdocs/ecommerceproject/frontend/src/Components/ProductList.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport './ProductList.css';\r\nimport { request, gql } from 'graphql-request';\r\nimport CartIcon from '../assets/carticon.svg';\r\nimport { Link } from 'react-router-dom';\r\nimport { useCategory } from '../context/CategoryContext';\r\nimport { useCart } from '../context/CartContext';\r\n\r\nconst ProductList = () => {\r\n  const { activeCategory } = useCategory();\r\n  const [products, setProducts] = useState([]);\r\n  const [loading, setLoading] = useState(false); // Add loading state\r\n  const { addToCart } = useCart();\r\n\r\n  useEffect(() => {\r\n    const fetchProducts = async () => {\r\n      setLoading(true); // Start loading\r\n      const endpoint = 'https://scandiwebtask-c44363ca7aa2.herokuapp.com/graphql.php';\r\n      const query = gql`\r\n        query($category: String) {\r\n          products(category: $category) {\r\n            id\r\n            name\r\n            inStock\r\n            category\r\n            imageUrl\r\n            prices {\r\n              amount\r\n              currencySymbol\r\n            }\r\n            attributes {\r\n              id\r\n              name\r\n              items {\r\n                id\r\n                display_value\r\n                value\r\n              }\r\n            }\r\n          }\r\n        }\r\n      `;\r\n\r\n      const categoryValue = activeCategory === 'all' ? null : activeCategory === 'clothes' ? '2' : '3';\r\n\r\n      try {\r\n        const data = await request(endpoint, query, { category: categoryValue });\r\n        setProducts(data.products);\r\n      } catch (error) {\r\n        console.error('Error fetching products:', error);\r\n      } finally {\r\n        setLoading(false); // End loading\r\n      }\r\n    };\r\n\r\n    fetchProducts();\r\n  }, [activeCategory]);\r\n\r\n  const handleQuickShop = (event, product) => {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    const selectedColor = product.attributes.find(attr => attr.name === \"Color\")?.items[0]?.value || \"\";\r\n    const selectedCapacity = product.attributes.find(attr => attr.name === \"Capacity\")?.items[0]?.value || \"\";\r\n    const selectedSize = product.attributes.find(attr => attr.name === \"Size\")?.items[0]?.value || \"\";\r\n    const selectedTouchID = product.attributes.find(attr => attr.name === \"Touch ID in keyboard\")?.items[0]?.value || \"\";\r\n    const selectedUSBPorts = product.attributes.find(attr => attr.name === \"With USB 3 ports\")?.items[0]?.value || \"\";\r\n\r\n    const productWithDefaults = {\r\n      ...product,\r\n      selectedColor,\r\n      selectedCapacity,\r\n      selectedSize,\r\n      selectedTouchID,\r\n      selectedUSBPorts,\r\n      price: product.prices?.[0]?.amount || 0,\r\n      quantity: 1,\r\n    };\r\n\r\n    addToCart(productWithDefaults);\r\n  };\r\n\r\n  const filteredProducts = activeCategory === 'all'\r\n    ? products\r\n    : products.filter(product => activeCategory === 'clothes' ? product.category === '2' : product.category === '3');\r\n\r\n  return (\r\n    <div className=\"product-list-container\">\r\n      <h2>{activeCategory === 'all' ? 'all' : activeCategory}</h2>\r\n      {loading ? (\r\n        <p>Loading products...</p> // Display loading message while fetching\r\n      ) : (\r\n        <div className=\"product-grid\">\r\n          {filteredProducts.length === 0 && <p>No products available.</p>}\r\n          {filteredProducts.map((product) => (\r\n            <div\r\n              key={product.id}\r\n              className={`product-card ${product.inStock ? '' : 'out-of-stock'}`}\r\n              data-testid={`product-${product.name.toLowerCase().replace(/\\s+/g, '-')}`}\r\n            >\r\n              <Link to={`/product/${product.id}`} className=\"product-image-link\">\r\n                <img\r\n                  src={product.imageUrl || 'default-image-url'}\r\n                  alt={product.name}\r\n                  className=\"product-image\"\r\n                  style={{ filter: product.inStock ? 'none' : 'grayscale(100%)' }}\r\n                />\r\n                {!product.inStock && (\r\n                  <div className=\"out-of-stock-label\">OUT OF STOCK</div>\r\n                )}\r\n              </Link>\r\n              <div className=\"product-info\">\r\n                <h3>{product.name}</h3>\r\n                <p>\r\n                  {product.prices?.[0]?.currencySymbol || \"$\"}\r\n                  {(product.prices?.[0]?.amount || 0).toFixed(2)}\r\n                </p>\r\n              </div>\r\n              {product.inStock && (\r\n                <div className=\"quick-shop\" onClick={(e) => handleQuickShop(e, product)}>\r\n                  <img src={CartIcon} alt=\"Cart\" />\r\n                </div>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProductList;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}